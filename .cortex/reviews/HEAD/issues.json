{
  "scanDate": "2025-01-12T20:05:00Z",
  "branch": "HEAD",
  "commit": "HEAD",
  "summary": {
    "totalIssues": 5,
    "criticalIssues": 0,
    "highIssues": 0,
    "mediumIssues": 2,
    "lowIssues": 3,
    "filesScanned": 22,
    "gateStatus": "go"
  },
  "issues": [
    {
      "id": "MED-001",
      "severity": "medium",
      "category": "brAInwav Branding",
      "file": "packages/mcp-core/src/tools/web-fetch-tool.ts",
      "line": 76,
      "rule": "brAInwav.error-branding-format",
      "title": "Error message lacks required brAInwav branding format",
      "description": "Error message contains brAInwav mention but lacks required structured branding with brand:brAInwav JSON format",
      "code": "throw new ToolExecutionError(\n        `[brAInwav] Network request to ${url} blocked: ${blockReason}`\n      );",
      "evidence": {
        "lines": [
          75,
          76,
          77
        ],
        "context": "Network blocking error in web fetch tool"
      },
      "fix": {
        "type": "code",
        "description": "Update error message to include structured brAInwav branding",
        "code": "throw new ToolExecutionError(\n        `[brAInwav] Network request to ${url} blocked: ${blockReason}`,\n        { brand: \"brAInwav\", component: \"mcp-core\", tool: \"web-fetch\" }\n      );"
      },
      "test": "Add test verifying error objects contain proper branding metadata"
    },
    {
      "id": "MED-002",
      "severity": "medium",
      "category": "Observability",
      "file": "packages/mcp-server/scripts/build-single.mjs",
      "line": 1,
      "rule": "observability.telemetry-missing",
      "title": "Build script lacks telemetry and brAInwav branding",
      "description": "Critical build script missing observability telemetry and brAInwav structured logging",
      "code": "#!/usr/bin/env node\nimport { build } from 'tsup';",
      "evidence": {
        "lines": [
          1,
          2,
          3
        ],
        "context": "Build script entry point without branding or telemetry"
      },
      "fix": {
        "type": "code",
        "description": "Add structured logging with brAInwav branding to build script",
        "code": "#!/usr/bin/env node\nconsole.log(JSON.stringify({\"brand\":\"brAInwav\",\"component\":\"mcp-server\",\"level\":\"info\",\"msg\":\"build started\"}));\nimport { build } from 'tsup';"
      },
      "test": "Add test to verify build script logs contain proper branding"
    },
    {
      "id": "LOW-001",
      "severity": "low",
      "category": "brAInwav Branding",
      "file": "packages/a2a/a2a-core/src/schema-registry.ts",
      "line": 89,
      "rule": "brAInwav.error-branding-format",
      "title": "Inconsistent brAInwav branding in error message",
      "description": "Error message uses inconsistent branding format - should use structured JSON branding",
      "code": "throw new Error(`[brAInwav] Invalid version format: ${version}`);",
      "evidence": {
        "lines": [
          89
        ],
        "context": "Version validation error in schema registry"
      },
      "fix": {
        "type": "code",
        "description": "Update to consistent brAInwav branding format with structured metadata",
        "code": "const error = new Error(`[brAInwav] Invalid version format: ${version}`);\nerror.brand = \"brAInwav\";\nerror.component = \"a2a-core\";\nthrow error;"
      },
      "test": "Add test verifying error branding consistency across A2A core"
    },
    {
      "id": "LOW-002",
      "severity": "low",
      "category": "brAInwav Branding",
      "file": "packages/a2a-services/schema-registry/src/service.ts",
      "line": 47,
      "rule": "brAInwav.error-branding-format",
      "title": "Error message branding inconsistency in service layer",
      "description": "Service error lacks structured brAInwav branding format consistency",
      "code": "throw new Error(`[brAInwav] Invalid version comparison: ${a} vs ${b}`);",
      "evidence": {
        "lines": [
          47
        ],
        "context": "Version comparison error in schema registry service"
      },
      "fix": {
        "type": "code",
        "description": "Add structured branding metadata to error objects",
        "code": "const error = new Error(`[brAInwav] Invalid version comparison: ${a} vs ${b}`);\nerror.brand = \"brAInwav\";\nerror.component = \"a2a-services\";\nthrow error;"
      },
      "test": "Add test ensuring service errors have proper branding metadata"
    },
    {
      "id": "LOW-003",
      "severity": "low",
      "category": "Code Quality",
      "file": "packages/mcp-server/src/index.ts",
      "line": 45,
      "rule": "codestyle.function-length",
      "title": "Long function with mixed concerns in server initialization",
      "description": "Main server initialization function handles multiple concerns - telemetry, connectors, and error handling",
      "code": "const initializeConnectors = async (): Promise<void> => {\n  // 50+ lines of mixed telemetry and connector logic\n};",
      "evidence": {
        "lines": [
          45,
          90
        ],
        "context": "Mixed concerns in server initialization function"
      },
      "fix": {
        "type": "refactor",
        "description": "Split initialization function into separate concerns: initializeTelemetry(), initializeConnectors(), setupErrorHandling()",
        "code": "const initializeTelemetry = async () => { /* telemetry setup */ };\nconst initializeConnectors = async () => { /* connector setup */ };\nconst setupErrorHandling = () => { /* error handling */ };"
      },
      "test": "Add tests for each initialization function independently"
    }
  ],
  "compliance": {
    "brAInwavPolicy": {
      "status": "compliant-with-minor-issues",
      "violations": 0,
      "brandingInconsistencies": 4,
      "categories": [
        "branding-format",
        "structured-logging"
      ]
    },
    "codeStyle": {
      "status": "compliant",
      "issues": 1
    },
    "security": {
      "status": "compliant",
      "issues": 0
    },
    "structuredLogging": {
      "status": "needs-improvement",
      "brandingPresent": true,
      "consistencyIssues": 3
    }
  },
  "recommendations": [
    "Standardize brAInwav error branding format across all packages to include structured metadata",
    "Add telemetry and structured logging to build scripts with proper brAInwav branding",
    "Implement consistent error object branding pattern in A2A core and services",
    "Refactor large initialization functions into smaller, single-purpose functions",
    "Create brAInwav branding helper utilities to ensure consistency across components",
    "Add comprehensive tests to verify branding metadata is properly attached to all error objects"
  ]
}