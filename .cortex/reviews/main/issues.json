[
  {
    "file": "scripts/mcp/migrate-packages.sh",
    "line": 149,
    "end_line": 149,
    "severity": "medium",
    "category": "brainwav-prohibition",
    "description": "TODO comment in production migration script violates brAInwav production standards",
    "evidence": "# TODO: Create actual configuration based on MCP server structure",
    "fix": "Replace TODO with immediate implementation or remove if not needed for current migration",
    "tests_to_add": "Add test to verify no TODO/FIXME comments exist in production scripts",
    "rule": "brainwav.todo-in-prod-path"
  },
  {
    "file": "scripts/mcp/migrate-packages.sh",
    "line": 168,
    "end_line": 168,
    "severity": "medium",
    "category": "brainwav-prohibition",
    "description": "Placeholder implementation in production migration script",
    "evidence": "log \"Configuration update placeholder - implementation needed\"",
    "fix": "Implement actual configuration updates or remove if not required for this migration",
    "tests_to_add": "Add validation test to ensure all migration steps are fully implemented",
    "rule": "brainwav.mock-response-in-prod"
  },
  {
    "file": "scripts/mcp/validate-new-stack.sh",
    "line": 114,
    "end_line": 114,
    "severity": "medium",
    "category": "brainwav-prohibition",
    "description": "Placeholder validation for tool availability",
    "evidence": "record_result \"Tool-$tool\" 0 \"Tool availability placeholder\"",
    "fix": "Implement actual tool availability validation using MCP server API",
    "tests_to_add": "Add test to verify tool validation checks are functional, not placeholders",
    "rule": "brainwav.mock-response-in-prod"
  },
  {
    "file": "scripts/mcp/validate-new-stack.sh",
    "line": 171,
    "end_line": 171,
    "severity": "medium",
    "category": "brainwav-prohibition",
    "description": "Placeholder validation for governance features",
    "evidence": "record_result \"Governance-$feature\" 0 \"Feature available placeholder\"",
    "fix": "Implement actual governance feature validation or remove placeholder checks",
    "tests_to_add": "Add test to verify governance validation is functional",
    "rule": "brainwav.mock-response-in-prod"
  },
  {
    "file": "scripts/mcp/validate-new-stack.sh",
    "line": 143,
    "end_line": 143,
    "severity": "medium",
    "category": "brainwav-prohibition",
    "description": "Simulated tool discovery call instead of actual implementation",
    "evidence": "sleep 0.1  # Placeholder for actual tool discovery call",
    "fix": "Replace with actual tool discovery implementation using MCP server API",
    "tests_to_add": "Add performance test with real tool discovery calls",
    "rule": "brainwav.mock-response-in-prod"
  },
  {
    "file": "scripts/mcp/migrate-packages.sh",
    "line": 22,
    "end_line": 36,
    "severity": "medium",
    "category": "brainwav-branding",
    "description": "Logging functions missing brAInwav branding and structured logging",
    "evidence": "log(), error(), warn(), success() functions without brAInwav branding",
    "fix": "Add brAInwav branding and structured logging with trace_id and brand fields",
    "tests_to_add": "Add test to verify all logs contain brAInwav branding and structured format",
    "rule": "brainwav.branding.missing-in-logs"
  },
  {
    "file": "scripts/mcp/validate-new-stack.sh",
    "line": 19,
    "end_line": 22,
    "severity": "medium",
    "category": "brainwav-branding",
    "description": "Logging functions missing brAInwav branding",
    "evidence": "log(), error(), warn(), success() functions without brAInwav branding",
    "fix": "Add brAInwav branding and structured logging with trace_id and brand fields",
    "tests_to_add": "Add test to verify all logs contain brAInwav branding and structured format",
    "rule": "brainwav.branding.missing-in-logs"
  },
  {
    "file": "scripts/mcp/rollback-migration.sh",
    "line": 20,
    "end_line": 23,
    "severity": "medium",
    "category": "brainwav-branding",
    "description": "Logging functions missing brAInwav branding",
    "evidence": "log(), error(), warn(), success() functions without brAInwav branding",
    "fix": "Add brAInwav branding and structured logging with trace_id and brand fields",
    "tests_to_add": "Add test to verify all logs contain brAInwav branding and structured format",
    "rule": "brainwav.branding.missing-in-logs"
  },
  {
    "file": "scripts/start-enhanced-mcp-server-governance.sh",
    "line": 56,
    "end_line": 58,
    "severity": "medium",
    "category": "brainwav-branding",
    "description": "Log function missing brAInwav branding and structured logging",
    "evidence": "log() { echo \"[MCP-GOV] $*\" >&2; }",
    "fix": "Add brAInwav branding, structured logging with trace_id, brand field, and proper error handling",
    "tests_to_add": "Add test to verify startup script uses brAInwav branded structured logging",
    "rule": "brainwav.branding.missing-in-logs"
  },
  {
    "file": "scripts/mcp/migrate-packages.sh",
    "line": 74,
    "end_line": 77,
    "severity": "low",
    "category": "logic",
    "description": "Missing backup directory creation validation",
    "evidence": "if [[ ! -d \"$BACKUP_DIR\" ]]; then error \"Backup directory not found\"",
    "fix": "Add backup directory creation step or verify backup creation process",
    "tests_to_add": "Add test to verify backup directory is created before migration starts"
  },
  {
    "file": "packages/connectors/config/mcp-external-providers.json",
    "line": 36,
    "end_line": 38,
    "severity": "low",
    "category": "security",
    "description": "Wildcard API key stored in environment variable without validation",
    "evidence": "\"env\": \"WILDCARD_API_KEY\"",
    "fix": "Add API key format validation and secure handling procedures",
    "tests_to_add": "Add test to validate API key format and secure handling"
  },
  {
    "file": "scripts/start-enhanced-mcp-server-governance.sh",
    "line": 102,
    "end_line": 104,
    "severity": "low",
    "category": "observability",
    "description": "Missing structured logging for API key warnings",
    "evidence": "log \"WARNING: WILDCARD_API_KEY not set. DeepContext may have limited functionality.\"",
    "fix": "Add structured logging with brand field and trace_id for warnings",
    "tests_to_add": "Add test to verify structured logging format for warnings"
  },
  {
    "file": "scripts/mcp/validate-new-stack.sh",
    "line": 124,
    "end_line": 127,
    "severity": "low",
    "category": "logic",
    "description": "Microsoft Learn connectivity check uses unreliable endpoint",
    "evidence": "curl -s --connect-timeout 10 \"https://learn.microsoft.com/api/mcp/health\"",
    "fix": "Verify correct Microsoft Learn MCP health endpoint or implement proper health check",
    "tests_to_add": "Add test to verify correct endpoint connectivity"
  },
  {
    "file": "package.json",
    "line": 410,
    "end_line": 426,
    "severity": "low",
    "category": "security",
    "description": "New package versions should be pinned for security",
    "evidence": "\"@brainwav/cortex-vibe-mcp\": \"^0.0.25\", \"arxiv-semantic-search-mcp\": \"^0.0.5\"",
    "fix": "Pin exact versions for production packages or implement strict version ranges",
    "tests_to_add": "Add test to verify package version pins meet security requirements"
  },
  {
    "file": "scripts/mcp/migrate-packages.sh",
    "line": 216,
    "end_line": 217,
    "severity": "low",
    "category": "observability",
    "description": "Missing trace context in migration logging",
    "evidence": "main \"$@\" 2>&1 | tee \"$LOG_DIR/migration-$(date +%Y%m%d-%H%M%S).log\"",
    "fix": "Add W3C trace_id propagation and structured logging with brand field",
    "tests_to_add": "Add test to verify trace context is propagated in migration logs"
  }
]