{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Agent Lifecycle CloudEvents Schema",
	"description": "Schema for agent lifecycle events in Cortex-OS",
	"type": "object",
	"properties": {
		"specversion": {
			"type": "string",
			"const": "1.0"
		},
		"type": {
			"type": "string",
			"enum": [
				"agent.started",
				"agent.completed",
				"agent.failed",
				"agent.cancelled"
			]
		},
		"id": {
			"type": "string",
			"pattern": "^[0123456789ABCDEFGHJKMNPQRSTVWXYZ]{26}$",
			"description": "ULID"
		},
		"source": {
			"type": "string",
			"pattern": "^packages/agents/[a-z-]+$",
			"examples": [
				"packages/agents/code-analysis",
				"packages/agents/test-generation",
				"packages/agents/documentation"
			]
		},
		"time": {
			"type": "string",
			"format": "date-time"
		},
		"datacontenttype": {
			"type": "string",
			"const": "application/json"
		},
		"data": {
			"type": "object",
			"properties": {
				"runId": {
					"type": "string",
					"pattern": "^[0123456789ABCDEFGHJKMNPQRSTVWXYZ]{26}$",
					"description": "ULID"
				},
				"agentName": {
					"type": "string"
				},
				"workflowId": {
					"type": "string"
				},
				"inputs": {
					"type": "object"
				},
				"outputs": {
					"type": "object"
				},
				"evidence": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"type": {
								"type": "string",
								"enum": ["file", "url", "hash", "proof"]
							},
							"pointer": {
								"type": "object",
								"properties": {
									"url": {
										"type": "string",
										"format": "uri"
									},
									"file": {
										"type": "string"
									},
									"line": {
										"type": "integer",
										"minimum": 1
									},
									"hash": {
										"type": "string"
									}
								}
							}
						},
						"required": ["type", "pointer"]
					}
				},
				"providerTrace": {
					"type": "object",
					"properties": {
						"provider": {
							"type": "string",
							"enum": ["mlx", "ollama", "anthropic", "openai"]
						},
						"model": {
							"type": "string"
						},
						"latencyMs": {
							"type": "number",
							"minimum": 0
						},
						"tokensUsed": {
							"type": "integer",
							"minimum": 0
						}
					},
					"required": ["provider", "model"]
				}
			},
			"required": ["runId", "agentName"]
		}
	},
	"required": [
		"specversion",
		"type",
		"id",
		"source",
		"time",
		"datacontenttype",
		"data"
	]
}
