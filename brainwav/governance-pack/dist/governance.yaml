metadata:
  schemaVersion: https://cortex-os.brainwav.dev/schemas/agentic.core.schema.json
  packVersion: 0.1.0
  generatedAt: 2025-12-03T00:39:54.121Z
  sourceShas:
    AGENTIC_WORKFLOWS.cortex-os.md: 1444a979a6238771d8306c7962f96d8d6262df02dd73f07d1d0737945e0d17c9
    AGENT_CHARTER.md: 70953d4e7433e886150fcab9daa1dc8c7a735e5ec6877499fd8832720a3900f4
    agentic-coding-workflow.md: 7ea61989105a13f64ec81c46cb018b5655b54268bcd8831f4212eec819c72c76
    cortex-aegis.md: cddf030cc8be93055bbd2493f90de926c28f58fd1859d99b416ff95fb1da22cd
    governance-maintainers.md: 91ace01d09b10d30e9607c41b1e55ce1fe0bee0aa2fadb929aa7e5583f465590
    governance-quickstart.md: 1795f44dd28df68f335d00d2add94d6617f43ea0fbe92fb743394f8387a6ced3
    checklists.cortex-os.md: ab1a82f3f5d7b52a4c7bc590596207b336c80186b173c7e648d1b5c2ed3eb144
    constitution.md: 47b0df7a7aafcb7cc3fb512290a7c2b2d0688b780ea73520fb1a40185531e5b9
    llm-threat-controls.md: 75bb7f77caa566add4489259f97512eed84e52a0718eb0b2e3de4f426687fbf1
    skills-system-governance.md: f3fbbca5b4516d71139d66610c992bd461a4fdc85c45b840fedc2fe3fb7ce64f
    README.md: 5ccaa087db6be2aee1c4d42a8b82223c5af1b1f653aa93331189361f0463c301
    vision.md: ee5cbbf7592b3c00ef92e310682bb8ce289aa78e2cd56de173bcb77cc76a492f
    CODESTYLE.md: f10d53cd89ad9ff279129c4e357b27c3c9216ffe98055b3b539ce6055de1def2
    SECURITY.md: e42c9934307326c19ef9b6483d3742be7522df4b6ae712a1cc5c0c2d2e79177d
workflow:
  phases:
    - id: R
      name: Ready
      description: Plan and preflight
    - id: G
      name: Green
      description: Implement under guardrails
    - id: F
      name: Finish
      description: Stabilise and verify
    - id: REVIEW
      name: Review
      description: Human review and signoff
  gates:
    - id: G0
      name: Initialize
      summary: Classify task, create folder, capture metadata + tier.
      phase: R
    - id: G1
      name: Discover / Research
      summary: Understand existing behaviour, dependencies, academic context.
      phase: R
    - id: G2
      name: Plan / Design
      summary: Produce PLAN.md, risk register, and assurance/oversight validated approach.
      phase: R
    - id: G3
      name: Scaffold
      summary: Establish failing tests, feature flags, contracts, and wiring.
      phase: G
    - id: G4
      name: Implement
      summary: Execute plan (≤7 steps per arc) with TDD micro-loops.
      phase: G
    - id: G5
      name: Verify
      summary: Run tests, security/a11y/perf checks, gather Evidence Triplet.
      phase: F
    - id: G6
      name: Review
      summary: AI reviewer + human reviewer dispositions, waiver handling.
      phase: F
    - id: G7
      name: Document
      summary: Update docs, changelog, runbooks, arc manifests.
      phase: F
    - id: G8
      name: Ship
      summary: Deploy & flag management with rollback paths.
      phase: REVIEW
    - id: G9
      name: Monitor
      summary: Observe telemetry, model health, error budgets.
      phase: REVIEW
    - id: G10
      name: Archive
      summary: Preserve artefacts, update memory, close task.
      phase: REVIEW
  flows:
    - id: feature
      summary: Requires North-Star test + assurance/oversight at G2 and G5 (Aegis or project-equivalent).
      phases:
        - R
        - G
        - F
      gates:
        - G0
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
        - G7
      gatesOptional:
        - G8
        - G9
        - G10
    - id: research
      summary: Produces decision memo; code optional; assurance/oversight validates
        sources/time freshness.
      phases:
        - R
        - G
      gates:
        - G0
        - G1
        - G2
        - G3
      gatesOptional:
        - G10
    - id: fix
      summary: Needs reproducer, failing test, and postmortem if SEV ≥ 2.
      phases:
        - R
        - G
        - F
      gates:
        - G0
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
        - G7
      gatesOptional:
        - G8
        - G9
        - G10
    - id: refactor
      summary: Behaviour-preserving; emphasise invariants + perf baselines.
      phases:
        - R
        - G
        - F
      gates:
        - G0
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
        - G7
      gatesOptional:
        - G10
    - id: review
      summary: No authoring; consumes Evidence Triplet + manifests.
      phases:
        - F
        - REVIEW
      gates:
        - G5
        - G6
        - G7
        - G10
      gatesOptional: []
  transitions:
    - from: R
      to: G
      requirements:
        - New acceptance/unit tests **fail first**, then **pass** on the next
          commit
        - "`TIME_FRESHNESS:OK tz=<IANA> today=<YYYY-MM-DD>` token present"
        - Oversight log (`brAInwav-vibe-check`) stored in `logs/vibe-check/`
        - Threat model + data classification updated against OWASP ASVS 5.0.0,
          OWASP LLM Top 10 (2025 v1.1), and NIST SSDF controls
    - from: G
      to: F
      requirements:
        - "`pnpm test` **passes**"
        - Coverage ≥ **90%** global & **95%** changed lines
        - Mutation ≥ **90%** (where enabled)
        - Latest model-health log includes engine, model IDs, vector dims/norms,
          P95 latency
        - SBOM + provenance artifacts generated at cyclonedx@1.7/1.2 (or
          stricter project default) and attached to the task folder
    - from: F
      to: REVIEW
      requirements:
        - A11y reports attached
        - "Security scanners: Semgrep (blockers), OSV clean, gitleaks zero
          secrets"
        - "`pnpm structure:validate` **passes**"
        - "`pnpm models:health && pnpm models:smoke` evidence attached (**live**
          only)"
        - Local Memory parity entry appended (decisions/refactors)
limits:
  stepBudget: 7
  askFirst: 3
evidence:
  tripletRequired: true
  runManifestRequired: true
  requiredTokens:
    - Step Budget ≤ 7
    - Ask-First ≤ 3
    - Evidence Triplet
qualityGates:
  coverage:
    global: 90
    changedLines: 95
  mutation:
    global: 90
  a11y:
    standard: WCAG 2.2 AA
  securityScanners:
    - semgrep
    - gitleaks
    - osv
  supplyChain:
    sbom: cyclonedx@1.7
    slsa: "1.2"
    signing: cosign-v3-bundle
governance:
  precedence:
    - 00-core/constitution.md
    - 00-core/AGENT_CHARTER.md
    - 10-flow/governance-quickstart.md
    - 10-flow/agentic-coding-workflow.md
    - 10-flow/cortex-aegis.md
    - 20-checklists/checklists.cortex-os.md
    - 00-core/vision.md
    - 00-core/llm-threat-controls.md
    - 00-core/skills-system-governance.md
    - CODESTYLE.md
    - SECURITY.md
  hashIndexPath: /.cortex/rules/governance-index.json
  requireHashVerification: true
operationalPlaybooks:
  rollout:
    summary: Profile rollout playbook (Q1).
    steps:
      - Map teams/services to a profile with an assigned DRI and record in the rollout brief.
      - Publish a one-page brief linking to this pack; acknowledge receipt from all teams.
      - Pilot one greenfield and one brownfield service; tag chosen profile in PR/task templates.
      - Add CI or template reminders for profile selection; schedule a retro after two sprints.
  metrics:
    summary: Quality/flow metrics by profile (Q2).
    steps:
      - Slice CI results by profile and gate; report coverage/mutation on changed lines and Evidence Triplet completeness.
      - Track waiver volume/reasons with expiry + mitigation; monitor lead time and post-merge defect rate.
      - For brownfield, publish weekly uplift deltas on touched code (coverage/mutation).
  mixedSurfaces:
    summary: Mixed regulated/consumer surfaces (Q3).
    steps:
      - Apply the strictest profile when regulated/data-sensitive code is touched; require profile + data-class tags in PRs.
      - Document compensating controls with expiry in the risk register; use feature flags/shadow traffic where needed.
      - Ensure cross-surface regression tests and observability cover regulated vs. consumer paths.
  standards:
    summary: Standards upkeep (Q4).
    steps:
      - Run a quarterly standards review (SLSA, CycloneDX, WCAG, NIST/ISO/OWASP) with assigned DRIs and a watchlist.
      - Version profiles with change logs and effective dates; communicate migrations and waivers.
      - Keep CI/template drift checks between templates and dist outputs; document exceptions.
  training:
    summary: Onboarding and reinforcement (Q5).
    steps:
      - Publish a 10-minute onboarding guide + crib sheet in PR/task templates; record a short demo.
      - Include a profile rehearsal exercise for new joiners with reviewer sign-off.
      - Collect feedback after two weeks and iterate the materials.
profiles:
  greenfield:
    overrides:
      description: >
        Default strict profile for net-new services. Uses the full gate set, default coverage/mutation/a11y targets,
        live model health checks, and requires SBOM + signed provenance and WCAG 2.2 AA evidence.
      requiredGates:
        - G0
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
        - G7
      requiredStandards:
        - "NIST SSDF v1.1 (secure-by-default development)"
        - "ISO/IEC 42001:2023 AI management and transparency"
        - "OWASP ASVS 5.0.0 L2 + OWASP LLM Top 10 (2025 v1.1) mitigations"
        - "WCAG 2.2 AA for all user-impacting changes"
      qualityGates:
        coverage:
          global: 90
          changedLines: 95
        mutation:
          global: 90
      supplyChain:
        sbom: cyclonedx@1.7
        slsa: "1.2"
        signing: cosign-v3-bundle
  brownfield:
    overrides:
      description: >
        Transitional profile for existing/legacy systems. Prioritises rigor on changed code while staging uplift for
        untouched modules and enforcing compensating controls (feature flags, dark deploys, observability baselines).
      requiredGates:
        - G0
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
      stagedControls:
        - "Changed code meets ≥95% coverage and ≥90% mutation; legacy surfaces get uplift backlogs with due dates."
        - "Document risk register entries for gaps with explicit expiry/owners; waivers must reference mitigation evidence."
        - "Enable runtime guards (feature flags, traffic shadowing, replay tests) before rollout."
  regulated:
    overrides:
      description: >
        High-assurance profile for regulated or safety-critical workloads (finance, health, safety, education, civic).
        Adds privacy, safety, and release controls with mandatory human sign-off.
      requiredGates:
        - G0
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
        - G7
        - G8
        - G9
        - G10
      requiredStandards:
        - "NIST SSDF v1.1 + NIST AI RMF v1.0"
        - "ISO/IEC 27001:2022 controls mapped to delivery"
        - "ISO/IEC 42001:2023 governance + transparency statements"
        - "OWASP ASVS 5.0.0 L2/L3 + OWASP LLM Top 10 (2025 v1.1)"
        - "WCAG 2.2 AA with assistive tech validation"
      additionalEvidence:
        - "Data protection impact assessment (DPIA) and privacy review where personal data is processed."
        - "Signed SBOM (cyclonedx@1.7) + provenance (1.2) for every release artifact."
        - "Model-health, bias, and safety evaluations recorded alongside the Evidence Triplet."
