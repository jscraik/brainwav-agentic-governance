version: "1.0.0"
metadata:
  generatedAt: "2025-12-31"
  owner: "brAInwav Governance"
  profile: "core"
controls:
  - id: CORE-GOV-001
    intent: "Prevent policy drift via hash-pinned governance index."
    risk: "Unauthorized governance changes or stale policy enforcement."
    owner: "Governance"
    pack: core
    modes: ["creative", "delivery"]
    automation:
      local: ["pnpm governance:sync-hashes:check"]
      ci: ["hash-drift job"]
    evidence:
      type: "hash-index"
      paths:
        - "brainwav/governance/90-infra/governance-index.json"
    mappings:
      - standard: "NIST SSDF v1.1"
        ref: "PO (Prepare the Organization)"

  - id: CORE-GOV-002
    intent: "Require Evidence Triplet for behavioral change."
    risk: "Unverifiable changes and weak audit trails."
    owner: "Delivery"
    pack: core
    modes: ["delivery"]
    automation:
      local: ["pnpm governance:validate-evidence"]
      ci: ["governance-validate job"]
    evidence:
      type: "triplet"
      paths:
        - "tasks/<slug>/logs/tests/milestone.log"
        - "tasks/<slug>/json/contracts-snapshot.json"
        - "tasks/<slug>/json/reviewer.json"
    mappings:
      - standard: "NIST SSDF v1.1"
        ref: "PW (Produce Well-Secured Software)"

  - id: CORE-GOV-003
    intent: "Keep delivery arcs small via Step Budget and Ask-First caps."
    risk: "Large, unreviewable changes and unclear intent."
    owner: "Delivery"
    pack: core
    modes: ["creative", "delivery"]
    automation:
      local: ["pnpm governance:validate", "pnpm task:validate"]
      ci: ["governance-validate job"]
    evidence:
      type: "run-manifest"
      paths:
        - "tasks/<slug>/json/run-manifest.json"
    mappings:
      - standard: "NIST SSDF v1.1"
        ref: "PO, PW"

  - id: CORE-SEC-001
    intent: "Detect vulnerabilities and secrets before merge."
    risk: "Injection, dependency and secret exposure."
    owner: "Security"
    pack: core
    modes: ["delivery"]
    automation:
      local: ["pnpm security:scan (where configured)"]
      ci: ["Semgrep", "Gitleaks", "OSV"]
    evidence:
      type: "scan-logs"
      paths:
        - "tasks/<slug>/logs/security/"
    mappings:
      - standard: "OWASP Top 10:2025"
      - standard: "OWASP ASVS 5.0.0"

  - id: CORE-SC-001
    intent: "Maintain supply-chain integrity with SBOM, provenance, signing."
    risk: "Supply-chain compromise or unverifiable artifacts."
    owner: "Release"
    pack: core
    modes: ["delivery"]
    automation:
      local: ["pnpm sbom:generate", "pnpm provenance:generate"]
      ci: ["CycloneDX", "SLSA Provenance", "Cosign", "Scorecard"]
    evidence:
      type: "supply-chain"
      paths:
        - "tasks/<slug>/sbom/"
        - "tasks/<slug>/attestations/"
    mappings:
      - standard: "SLSA Provenance v1.2"
      - standard: "CycloneDX 1.7"
      - standard: "SPDX 3.0.1"
      - standard: "OpenSSF Scorecard"

  - id: CORE-A11Y-001
    intent: "Ensure user-facing changes meet WCAG 2.2 AA."
    risk: "Accessibility regressions and legal exposure."
    owner: "UX/Accessibility"
    pack: core
    modes: ["delivery"]
    automation:
      local: ["pnpm test:a11y"]
      ci: ["a11y-check job"]
    evidence:
      type: "a11y-reports"
      paths:
        - "tasks/<slug>/verification/wcag/"
    mappings:
      - standard: "WCAG 2.2 (ISO/IEC 40500:2025)"

  - id: CORE-AI-001
    intent: "Mitigate LLM-specific threats in agentic workflows."
    risk: "Prompt injection, data leakage, excessive agency."
    owner: "AI Safety"
    pack: core
    modes: ["creative", "delivery"]
    automation:
      local: ["pnpm governance:validate"]
      ci: ["governance-validate job"]
    evidence:
      type: "policy"
      paths:
        - "brainwav/governance/00-core/llm-threat-controls.md"
    mappings:
      - standard: "OWASP LLM Top 10 (2025 v1.1)"

  - id: CORE-AI-002
    intent: "Align AI system governance to risk management practices."
    risk: "Unmanaged AI risk and regulatory non-compliance."
    owner: "AI Governance"
    pack: core
    modes: ["delivery"]
    automation:
      local: ["pnpm oversight:vibe-check"]
      ci: ["oversight job"]
    evidence:
      type: "oversight"
      paths:
        - "tasks/<slug>/logs/vibe-check/"
    mappings:
      - standard: "NIST AI RMF 1.0 + GenAI Profile"
      - standard: "ISO/IEC 42001:2023"
