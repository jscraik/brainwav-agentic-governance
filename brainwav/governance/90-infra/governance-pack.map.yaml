# Anchors should use HTML comments: <!-- PACK:key=value -->; regex only runs as fallback when anchors are missing.
# Update this map when adding governance docs so render/build scripts stay aligned.
# Mapping file used by scripts/governance/build-pack.mjs to extract pack values without brittle parsing.
# overlay handling: keep anchors consistent across core + overlay layers.
# Preferred approach: place HTML-style anchors in source docs, e.g. <!-- PACK:limits.stepBudget=7 -->.
# When anchors are absent, fall back to the regex below; keep them tight to avoid false matches.
---
limits:
  stepBudget:
    file: 00-core/AGENT_CHARTER.md
    anchor: "PACK:limits.stepBudget"
    regex: "Step Budget (?:<=|≤)\\s*(\\d+)"
  askFirst:
    file: 00-core/AGENT_CHARTER.md
    anchor: "PACK:limits.askFirst"
    regex: "Ask-First (?:<=|≤)\\s*(\\d+)"

evidence:
  tripletRequired:
    file: AGENTS.md
    anchor: "PACK:evidence.tripletRequired"
    default: true
  runManifestRequired:
    file: AGENTS.md
    anchor: "PACK:evidence.runManifestRequired"
    default: true
  requiredTokens:
    file: AGENTS.md
    anchor: "PACK:evidence.requiredTokens"
    default:
      - service:
      - trace_id
      - traceparent

assurance:
  aegis:
    file: 10-flow/assurance-system.md
    anchor: "PACK:assurance.aegis"
  timeFreshness:
    file: 10-flow/assurance-system.md
    anchor: "PACK:assurance.timeFreshness"

qualityGates:
  coverage:
    file: constitution.md
    anchor: "PACK:quality.coverage"
  mutation:
    file: constitution.md
    anchor: "PACK:quality.mutation"
  a11y:
    file: constitution.md
    anchor: "PACK:quality.a11y"
  securityScanners:
    file: llm-threat-controls.md
    anchor: "PACK:quality.security"
  supplyChain:
    file: llm-threat-controls.md
    anchor: "PACK:quality.supplyChain"

structure:
  importBoundaries:
    file: structure-guard.json
  snapshotValidation:
    file: export-freeze.snapshot.json
  note: "structure-guard.json is core schema; pack-specific restrictions must be applied via overlays."

checklists:
  items:
    file: 20-checklists/checklists.md
  byPhase:
    file: 20-checklists/checklists.md

workflow:
  phases:
    file: agentic-coding-workflow.md
    section: "4.3 Phase Machine"
  gates:
    file: agentic-coding-workflow.md
  flows:
    file: agentic-coding-workflow.md
  transitions:
    file: agentic-coding-workflow.md
    section: "4.3 Phase Machine"

governance:
  precedence:
    file: 90-infra/governance-index.json
  hashIndexPath:
    file: 90-infra/governance-index.json
  requireHashVerification:
    file: AGENTS.md
    anchor: "PACK:governance.requireHashVerification"

sdd:
  specTemplate:
    file: templates/sdd/spec.md
  planTemplate:
    file: templates/sdd/plan.md
  tasksTemplate:
    file: templates/sdd/tasks.md
